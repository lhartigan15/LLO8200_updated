---
title: "Data Science - Week 1: Tools of the Trade"
subtitle: "Lecture Notes"
output:
    html_document: 
        theme: cerulean
---

# Welcome to Data Science! {#intro}

Today, we'll be working on getting you set up with the tools you will need for this class. Once you are set up, we'll do what we're here to do: analyze data!

Here's what we need to get done today:

1. Introductions
2. Installing R
3. Installing Rstudio
4. Learning the basic verbs of data analysis

## Introductions

We need two basic sets of tools for this class. We will need `R` to analyze data. We will need `RStudio` to help us interface with R and to produce documentation of our results. 

## Installing R

R is going to be the only programming language we will use. R is an extensible statistical programming environment that can handle all of the main tasks that we'll need to cover this semester: getting data, analyzing data and communicating data analysis. 

If you haven't already, you need to download R here: [https://cran.r-project.org/](https://cran.r-project.org/). 

## Installing Rstudio

When we work with R, we communicate via the command line. To help automate this process, we can write scripts, which contain all of the commands to be executed. These scripts generate various kinds of output, like numbers on the screen, graphics or reports in common formats (pdf, word). Most programming languages have several __I__ ntegrated __D__ evelopment __E__ nvironments (IDEs) that encompass all of these elements (scripts, command line interface, output). The primary IDE for R is Rstudio. 

If you haven't already, you need to download Rstudio here:
[https://www.rstudio.com/products/rstudio/download2/](https://www.rstudio.com/products/rstudio/download2/). You need the free Rstudio desktop version. 

## .Rmd files

Open the `01-Intro.Rmd` file. In Rstudio, go to File-->Open, then find the `01-Intro.Rmd` file in the directory. 

.Rmd files will be the only file format we work in this class. .Rmd files contain three basic elements:

1. Script that can be interpreted by R. 
2. Output generated by R, including tables and figures.
3. Text that can be read by humans. 

From a .Rmd file you can generate html documents, pdf documents, word documents, slides . . . lots of stuff. All class notes will be in .Rmd. All assignments will be turned in as .Rmd files, and your final project? You guessed it, .Rmd. 

In the `01-Intro.Rmd` file you'll notice that there are three open single quotes in a row, like so: ` ``` ` This indicates the start of a "code chunk" in our file. The first code chunk that we load will include a set of programs that we will need all semester long.  


## R Packages

When we say that R is extensible, we mean that people in the community can write programs that everyone else can use. These are called "packages." In these first few lines of code, I load a set of packages using the library command in R. The set of packages, called `tidyverse` were written by Hadley Wickham and play a key role in his book.  To install this set of packages, simply type in `install.packages("tidyverse")` at the R command prompt. 

To run the code below in R, you can:

- Press the "play" button next to the code chunk
- In OS X, place the cursor in the code chunk and hit `cmd+shift+enter`
- In Windows, place the cursor in the code chunk and hit `ctrl+shefit+enter`

```{r scorecard} 
## Clear environment - this will remove everything from your environment (optional, but I like to do this to start fresh)
rm(list=ls())

## Get necessary libraries-- if this doesn't work it's likely because you need to install the packages we're using!
library(tidyverse)
```

Now we're ready to load in data. The data frame will be our basic way of interacting with everything in this class. The `sc` data frame contains information from the college scorecard on 127 different colleges and universities. 

However, we first need to make sure that R is looking in the right place. R will automatically look for 
the data in the same folder where your .Rmd code file is saved. Therefore, if your data file is
saved in the same folder as your .Rmd file, you can simply use the "load" command. If your data file is
saved elsewhere, you need to modify your working directory to tell R where it can find your data. Both 
of these things are demonstrated below.

```{r load_data}
## Load in the data - IF the datafile is saved in the same place as my .Rmd file, this works
load("college.Rdata")

# IF the data is saved elsewhere, I need to tell R where it is:
#setwd("C:/Users/lacey/Google Drive/Teaching/Vanderbilt/LLO 8200 - Data Science/Async .Rmd files")

#I can run the function getwd() to confirm that it's what I want it to be
#getwd()

#you can also use drop downs under the FILES tab to the right OR you can use the "Session" tab at the top. Note that any time you use a point-and-click method and it isn't in code in your .Rmd when you go to knit, R will NOT point and click for you. 
```

Here are the variables in the `college.Rdata` dataset:

*Variable Name* :*Definition*
unitid: Unit ID

instnm: Institution Name

stabbr: State Abbreviation

year: Year

control: control of institution, 1=public, 2= private non-profit, 3=private for-profit

preddeg: predominant degree, 1= certificate, 2= associates, 3= bachelor's, 4=graduate

adm_rate: Proportion of Applicants Admitted

sat_avg: Midpoint of entrance exam scores, on SAT scale, math and verbal only

costt_4a: Average cost of attendance (tuition and room and board less all grant aid)

debt_mdn: Median debt of graduates

md_earn_ne_pg: Earnings of graduates who are not enrolled in higher education, six years after graduation

*Looking at datasets*

We can look at the first few rows and columns of `sc` by typing in the data name. 

We can look at the whole dataset using View. 
```{r look_at_data}
## What does this data look like? Look at the first few rows, first few variables
sc

#what if I wanted to look at the first 20 rows? we can use the "head" function
head(sc, 20)

#what if I want to see the last 20 rows? there's a "tail" function for that
tail(sc, 20)

## This is commented as you might not always want to run it, particularly when you're knitting your file. Delete the "#" sign below in order to run the command. 
#View(sc)
```

*Filter, Select, Arrange*

In exploring data, many times we want to look at smaller parts of the dataset. There are three commands we'll use today that help with this. 

-`filter` selects only those cases or rows that meet some logical criteria. 

-`select` selects only those variables or columns that meet some criteria

-`arrange` arranges the rows of a dataset in the way we want. 

For more on these, please see this [vignette](https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html).

Let's grab just the data for Vanderbilt, then look only at the average test scores and admit rate. 
```{r filter_select_arrange}
#Let's just take a look at our alma mater - Vandy! Filtering help's us handle ROWS of data.
sc%>%    
  filter(instnm=="Vanderbilt University")

#Now let's just look at variables of interest: institution name, admissions rate, and SAT average. Selecting helps us handle COLUMNS of data.
sc%>%
  filter(instnm=="Vanderbilt University")%>%
  select(instnm, adm_rate, sat_avg)
```

This is actually pretty powerful- we can quickly learn a lot just by looking at individuals. We can also get groups of institutions by specifying the characteristics of institutions we'd like to look at. For instance, let's look at institutions with admission rates of less than 10 percent. We'll then select three characteristics: name, admit rate and average SAT scores. Then we'll order the result by SAT scores. 
```{r}
## Just colleges with low admit rates: order by sat scores (- sat_avg gives descending)
sc%>%  
  filter(adm_rate < .1)%>%
  select(instnm, adm_rate, sat_avg)%>%
  arrange(-sat_avg)
```

*Summarizing Data*

We can summarize data by giving commands to the summarize operator. For instance, what if we wanted to know what average debt levels looked like across these colleges? 
```{r summarize}
## What's the average median debt?
sc%>%
  summarize(mean_debt=mean(debt_mdn, na.rm=TRUE))
```

*Combining Commands*
We can also combine commands, so that summaries are done on only a part of the dataset. Below, I summarize median debt for selective schools, and not very selective schools.  
```{r combining commands}
## What's the average median debt for very selective schools?
sc%>%
  filter(adm_rate<.1)%>%
  summarize(mean_debt=mean(debt_mdn, na.rm=TRUE))

## And for not very selective schools?
sc%>%
  filter(adm_rate>.3)%>%
  summarize(mean_debt=mean(debt_mdn, na.rm=TRUE))

## What's the average earnings  for very selective schools?
sc%>%
  filter(adm_rate<.1)%>%  
  summarize(mean_earnings=mean(md_earn_wne_p6, na.rm=TRUE))

## And for not very selective schools?
sc%>%
  filter(adm_rate>.3)%>%
  summarize(mean_earnings=mean(md_earn_wne_p6, na.rm=TRUE))
```

*Quick Exercise: What is the admission rate at UNC Chapel Hill?*
```{r}
sc%>%
  filter(instnm=="University of North Carolina at Chapel Hill")%>%
  select(instnm, adm_rate) 
```
Note: The answer in the async is incorrect. The right answer for the admission rate @ UNC Chapel Hill is: 0.3396. 
